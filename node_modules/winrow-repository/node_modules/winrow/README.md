### Installation

Install the dependencies and devDependencies and start the server.

```sh
$ npm install winrow
```

```
$ npm install winrow-repository
$ npm install winrow-transform
```
```js
const mappings = [...UserMapping];
const sandbox = {
  application: {
    pathServer: '/rest/api',
    enable: false,
    bridge: {
      database_local: {
        host: 'localhost',
        port: '27017',
        name: 'demoLocal',
      },
      database_server: {
        host: 'localhost',
        port: '27017',
        name: 'demoServer',
      }
    },
    mappings: mappings
  },
}
// connect database
const repository = require('winrow-repository')
repository.connect(sandbox)

// connect mapping
const transform = require('winrow-transform')
transform.mappings(sandbox)
```

In Node.js:
```js
const server = require('winrow');
// Get ProtoTypes In Server.
const {
  Promise,
  lodash,
  moment,
  returnCodes,
  validator
} = server;
const dataStore = require('winrow-repository').dataStore;
// Services

function ExampleServices() {
  // create services
  this.exampleCreate = function(args, opts) {
    const { loggingFactory, requestId } = opts;
    loggingFactory.debug('create begin', {requestId : `${requestId}`})
    return dataStore.create({
      type : 'name of model'
      data : {} || args
    })
    .then(result => '...do something then return result')
    .catch(err => {
      loggingFactory.error('create begin', {requestId : `${requestId}`})
      return Promise.reject(err);
    })
  }
  // get services
  this.exampleGet = function(args, opts) {
    const { loggingFactory } = opts;
    return dataStore.find({
      type : 'name of model',
      filter : {} || 'query with field model',
      projection : {} || 'get field in model',
      options : {} || 'pagination mongoose',
      populates : [
        {
          path : 'field of reference in model',
          select : 'get field in model of reference'
        }
      ]
    })
    .then(result => '... do something')
  }
  // get by id servers
  this.exampleGetById = function(args, opts) {
    const { loggingFactory } = opts;
    return dataStore.get({
      type : 'name of model',
      id : args.id,
      populates : [
        {
          path : 'field of reference in model',
          select : 'get field in model of reference'
        }
      ]
    })
    .then(result => '...do something')
  }
  // update server
  this.exampleUpdate = function(args, opts) {
    const { loggingFactory } = opts;
    return dataStore.update({
      type : 'name of model',
      id : args.id,
      data : {} || args
    })
    .then(result => '...do something')
  }
}

// mappings 

const mappings = [
  // create
  {
    path : '/example',
    method : 'POST',
    methodName : 'exampleCreate',
    serviceName : ExampleServices,
    input : {
      transform : function(req) {
        // schema 
        const schema = {
          type: 'object',
          properties: {
            name: { type: 'string' },
          },
          required: ['name']
        }
        // validate request
        const {valid, errors} = validator(schema, req.body);
        if(!valid) {
          return Promise.reject(errors);
        }
        return {
          name : req.body.name
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
  // get
   {
    pathName: '/example',
    method: 'GET',
    methodName: 'exampleGet',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          params: req.query
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          headers: {
            'X-Total-Count': response.total,
            'Access-Control-Expose-Headers': 'X-Total-Count'
          },
          body: response.data
        }
      }
    }
  },
  // get by id
  {
    pathName: '/example/:id',
    method: 'GET',
    methodName: 'exampleGetById',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          id: req.params.id
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
  // update
   {
    pathName: '/example/:id',
    method: 'PUT',
    methodName: 'exampleUpdate',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          id: req.params.id,
          ...req.body
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
]

// Example Connect API
[git hub](https:github.com/NguyenPhuocMinh/example-node-api)
```